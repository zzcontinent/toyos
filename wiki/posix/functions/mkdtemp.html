<!-- Copyright 2001-2013 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group's rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2013 The Open Group, All Rights Reserved -->
<title>mkdtemp</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/mkdir.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mkfifo.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>

<script type="text/javascript" language="JavaScript" src="../jscript/codes.js">
</script>

<basefont size="3"> 

<center><font size="2">The Open Group Base Specifications Issue 7, 2018 edition<br>
IEEE Std 1003.1-2017 (Revision of IEEE Std 1003.1-2008)<br>
Copyright &copy; 2001-2018 IEEE and The Open Group</font></center>

<hr size="2" noshade>
<a name="top"></a> <a name="mkdtemp"></a> <a name="tag_16_326"></a><!-- mkdtemp -->
 

<h4 class="mansect"><a name="tag_16_326_01"></a>NAME</h4>

<blockquote>mkdtemp, mkstemp - create a unique directory or file</blockquote>

<h4 class="mansect"><a name="tag_16_326_02"></a>SYNOPSIS</h4>

<blockquote class="synopsis">
<div class="box"><code><tt><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> #include &lt;<a href="../basedefs/stdlib.h.html">stdlib.h</a>&gt;<br>
<br>
 char *mkdtemp(char *</tt><i>template</i><tt>);<br>
 int mkstemp(char *</tt><i>template</i><tt>); <img src="../images/opt-end.gif" alt="[Option End]" border="0"></tt></code></div>

<tt><br>
</tt></blockquote>

<h4 class="mansect"><a name="tag_16_326_03"></a>DESCRIPTION</h4>

<blockquote>
<p>The <i>mkdtemp</i>() function shall create a directory with a unique name derived from <i>template</i>. The application shall
ensure that the string provided in <i>template</i> is a pathname ending with at least six trailing <tt>'X'</tt> characters. The
<i>mkdtemp</i>() function shall modify the contents of <i>template</i> by replacing six or more <tt>'X'</tt> characters at the end
of the pathname with the same number of characters from the portable filename character set. The characters shall be chosen such
that the resulting pathname does not duplicate the name of an existing file at the time of the call to <i>mkdtemp</i>(). The
<i>mkdtemp</i>() function shall use the resulting pathname to create the new directory as if by a call to:</p>

<pre>
<tt>mkdir(pathname, S_IRWXU)
</tt>
</pre>

<p>The <i>mkstemp</i>() function shall create a regular file with a unique name derived from <i>template</i> and return a file
descriptor for the file open for reading and writing. The application shall ensure that the string provided in <i>template</i> is a
pathname ending with at least six trailing <tt>'X'</tt> characters. The <i>mkstemp</i>() function shall modify the contents of
<i>template</i> by replacing six or more <tt>'X'</tt> characters at the end of the pathname with the same number of characters from
the portable filename character set. The characters shall be chosen such that the resulting pathname does not duplicate the name of
an existing file at the time of the call to <i>mkstemp</i>(). The <i>mkstemp</i>() function shall use the resulting pathname to
create the file, and obtain a file descriptor for it, as if by a call to:</p>

<pre>
<tt>open(pathname, O_RDWR|O_CREAT|O_EXCL, S_IRUSR|S_IWUSR)
</tt>
</pre>

<p>By behaving as if the O_EXCL flag for <a href="../functions/open.html"><i>open</i>()</a> is set, the function prevents any
possible race condition between testing whether the file exists and opening it for use.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_04"></a>RETURN VALUE</h4>

<blockquote>
<p>Upon successful completion, the <i>mkdtemp</i>() function shall return the value of <i>template</i>. Otherwise, it shall return
a null pointer and shall set <i>errno</i> to indicate the error.</p>

<p>Upon successful completion, the <i>mkstemp</i>() function shall return an open file descriptor. Otherwise, it shall return -1
and shall set <i>errno</i> to indicate the error.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_05"></a>ERRORS</h4>

<blockquote>
<p>The <i>mkdtemp</i>() function shall fail if:</p>

<dl compact>
<dt>[EACCES]</dt>

<dd>Search permission is denied on a component of the path prefix, or write permission is denied on the parent directory of the
directory to be created.</dd>

<dt>[EINVAL]</dt>

<dd>The string pointed to by <i>template</i> does not end in <tt>"XXXXXX"</tt>.</dd>

<dt>[ELOOP]</dt>

<dd>A loop exists in symbolic links encountered during resolution of the path of the directory to be created.</dd>

<dt>[EMLINK]</dt>

<dd>The link count of the parent directory would exceed {LINK_MAX}.</dd>

<dt>[ENAMETOOLONG]</dt>

<dd>
The length of a component of a pathname is longer than {NAME_MAX}.</dd>

<dt>[ENOENT]</dt>

<dd>A component of the path prefix specified by the <i>template</i> argument does not name an existing directory.</dd>

<dt>[ENOSPC]</dt>

<dd>The file system does not contain enough space to hold the contents of the new directory or to extend the parent directory of
the new directory.</dd>

<dt>[ENOTDIR]</dt>

<dd>A component of the path prefix names an existing file that is neither a directory nor a symbolic link to a directory.</dd>

<dt>[EROFS]</dt>

<dd>The parent directory resides on a read-only file system.</dd>
</dl>

<p>The <i>mkdtemp</i>() function may fail if:</p>

<dl compact>
<dt>[ELOOP]</dt>

<dd>More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the path of the directory to be created.</dd>

<dt>[ENAMETOOLONG]</dt>

<dd>
The length of a pathname exceeds {PATH_MAX}, or pathname resolution of a symbolic link produced an intermediate result with a
length that exceeds {PATH_MAX}.</dd>
</dl>

<p>The error conditions for the <i>mkstemp</i>() function are defined in <a href="../functions/open.html#"><i>open</i></a>.</p>
</blockquote>

<hr>
<div class="box"><em>The following sections are informative.</em></div>

<h4 class="mansect"><a name="tag_16_326_06"></a>EXAMPLES</h4>

<blockquote>
<h5><a name="tag_16_326_06_01"></a>Generating a Pathname</h5>

<p>The following example creates a file with a 10-character name beginning with the characters <tt>"file"</tt> and opens the file
for reading and writing. The value returned as the value of <i>fd</i> is a file descriptor that identifies the file.</p>

<pre>
<tt>#include &lt;stdlib.h&gt;
...
char template[] = "/tmp/fileXXXXXX";
int fd;
<br>
fd = mkstemp(template);
</tt>
</pre>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_07"></a>APPLICATION USAGE</h4>

<blockquote>
<p>It is possible to run out of letters.</p>

<p>Portable applications should pass exactly six trailing <tt>'X'</tt> s in the template and no more; implementations may treat any
additional trailing <tt>'X'</tt> s as either a fixed or replaceable part of the template. To be sure of only passing six, a fixed
string of at least one non- <tt>'X'</tt> character should precede the six <tt>'X'</tt> s.</p>

<p>Since <tt>'X'</tt> is in the portable filename character set, some of the replacement characters can be <tt>'X'</tt> s, leaving
part (or even all) of the template effectively unchanged.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_08"></a>RATIONALE</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_09"></a>FUTURE DIRECTIONS</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_10"></a>SEE ALSO</h4>

<blockquote>
<p><a href="../functions/getpid.html#"><i>getpid</i></a>, <a href="../functions/mkdir.html#tag_16_325"><i>mkdir</i></a>, <a href=
"../functions/open.html#"><i>open</i></a>, <a href="../functions/tmpfile.html#"><i>tmpfile</i></a>, <a href=
"../functions/tmpnam.html#"><i>tmpnam</i></a></p>

<p>XBD <a href="../basedefs/stdlib.h.html"><i>&lt;stdlib.h&gt;</i></a></p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_11"></a>CHANGE HISTORY</h4>

<blockquote>
<p>First released in Issue 4, Version 2.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_12"></a>Issue 5</h4>

<blockquote>
<p>Moved from X/OPEN UNIX extension to BASE.<br>
</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_326_13"></a>Issue 7</h4>

<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #143 is applied.</p>

<p>SD5-XSH-ERN-168 is applied, clarifying file permissions upon creation.</p>

<p>The <i>mkstemp</i>() function is moved from the XSI option to the Base.</p>

<p>The <i>mkdtemp</i>() function is added from The Open Group Technical Standard, 2006, Extended API Set Part 1.</p>

<p>POSIX.1-2008, Technical Corrigendum 1, XSH/TC1-2008/0380 [291], XSH/TC1-2008/0381 [324], and XSH/TC1-2008/0382 [291] are
applied.</p>

<p>POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0215 [567,669] is applied.</p>
</blockquote>

<div class="box"><em>End of informative text.</em></div>

<hr>
<p>&nbsp;</p>

<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX &reg; is a registered Trademark of The Open Group.<br>
POSIX &reg; is a registered Trademark of The IEEE.<br>
Copyright &copy; 2001-2018 IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>

<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/mkdir.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mkfifo.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>
</body>
</html>

