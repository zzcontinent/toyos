<!-- Copyright 2001-2013 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group's rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2013 The Open Group, All Rights Reserved -->
<title>open_memstream</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/open.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/pause.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>

<script type="text/javascript" language="JavaScript" src="../jscript/codes.js">
</script>

<basefont size="3"> 

<center><font size="2">The Open Group Base Specifications Issue 7, 2018 edition<br>
IEEE Std 1003.1-2017 (Revision of IEEE Std 1003.1-2008)<br>
Copyright &copy; 2001-2018 IEEE and The Open Group</font></center>

<hr size="2" noshade>
<a name="top"></a> <a name="open_memstream"></a> <a name="tag_16_358"></a><!-- open_memstream -->
 

<h4 class="mansect"><a name="tag_16_358_01"></a>NAME</h4>

<blockquote>open_memstream, open_wmemstream - open a dynamic memory buffer stream</blockquote>

<h4 class="mansect"><a name="tag_16_358_02"></a>SYNOPSIS</h4>

<blockquote class="synopsis">
<div class="box"><code><tt><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> #include &lt;<a href="../basedefs/stdio.h.html">stdio.h</a>&gt;<br>
<br>
 FILE *open_memstream(char **</tt><i>bufp</i><tt>, size_t *</tt><i>sizep</i><tt>);<br>
<br>
<br>
 #include &lt;<a href="../basedefs/wchar.h.html">wchar.h</a>&gt;<br>
 FILE *open_wmemstream(wchar_t **</tt><i>bufp</i><tt>, size_t *</tt><i>sizep</i><tt>); <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></tt></code></div>

<tt><br>
</tt></blockquote>

<h4 class="mansect"><a name="tag_16_358_03"></a>DESCRIPTION</h4>

<blockquote>
<p>The <i>open_memstream</i>() and <i>open_wmemstream</i>() functions shall create an I/O stream associated with a dynamically
allocated memory buffer. The stream shall be opened for writing and shall be seekable.</p>

<p>The stream associated with a call to <i>open_memstream</i>() shall be byte-oriented.</p>

<p>The stream associated with a call to <i>open_wmemstream</i>() shall be wide-oriented.</p>

<p>The stream shall maintain a current position in the allocated buffer and a current buffer length. The position shall be
initially set to zero (the start of the buffer). Each write to the stream shall start at the current position and move this
position by the number of successfully written bytes for <i>open_memstream</i>() or the number of successfully written wide
characters for <i>open_wmemstream</i>(). The length shall be initially set to zero. If a write moves the position to a value larger
than the current length, the current length shall be set to this position. In this case a null character for
<i>open_memstream</i>() or a null wide character for <i>open_wmemstream</i>() shall be appended to the current buffer. For both
functions the terminating null is not included in the calculation of the buffer length.</p>

<p>After a successful <a href="../functions/fflush.html"><i>fflush</i>()</a> or <a href=
"../functions/fclose.html"><i>fclose</i>()</a>, the pointer referenced by <i>bufp</i> shall contain the address of the buffer, and
the variable pointed to by <i>sizep</i> shall contain the smaller of the current buffer length and the number of bytes for
<i>open_memstream</i>(), or the number of wide characters for <i>open_wmemstream</i>(), between the beginning of the buffer and the
current file position indicator.</p>

<p>After a successful <a href="../functions/fflush.html"><i>fflush</i>()</a> the pointer referenced by <i>bufp</i> and the variable
referenced by <i>sizep</i> remain valid only until the next write operation on the stream or a call to <a href=
"../functions/fclose.html"><i>fclose</i>()</a>.</p>

<p>After a successful <a href="../functions/fclose.html"><i>fclose</i>()</a>, the pointer referenced by <i>bufp</i> can be passed
to <a href="../functions/free.html"><i>free</i>()</a>.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_04"></a>RETURN VALUE</h4>

<blockquote>
<p>Upon successful completion, these functions shall return a pointer to the object controlling the stream. Otherwise, a null
pointer shall be returned, and <i>errno</i> shall be set to indicate the error.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_05"></a>ERRORS</h4>

<blockquote>
<p>These functions shall fail if:</p>

<dl compact>
<dt>[EMFILE]</dt>

<dd>{STREAM_MAX} streams are currently open in the calling process.</dd>
</dl>

<p>These functions may fail if:</p>

<dl compact>
<dt>[EINVAL]</dt>

<dd><i>bufp</i> or <i>sizep</i> are NULL.</dd>

<dt>[EMFILE]</dt>

<dd>{FOPEN_MAX} streams are currently open in the calling process.</dd>

<dt>[ENOMEM]</dt>

<dd>Memory for the stream or the buffer could not be allocated.</dd>
</dl>
</blockquote>

<hr>
<div class="box"><em>The following sections are informative.</em></div>

<h4 class="mansect"><a name="tag_16_358_06"></a>EXAMPLES</h4>

<blockquote>
<pre>
<tt>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
<br>
int
main (void)
{
    FILE *stream;
    char *buf;
    size_t len;
    off_t eob;
<br>
    stream = open_memstream (&amp;buf, &amp;len);
    if (stream == NULL)
        /* handle error */ ;
    fprintf (stream, "hello my world");
    fflush (stream);
    printf ("buf=%s, len=%zu\n", buf, len);
    eob = ftello(stream);
    fseeko (stream, 0, SEEK_SET);
    fprintf (stream, "good-bye");
    fseeko (stream, eob, SEEK_SET);
    fclose (stream);
    printf ("buf=%s, len=%zu\n", buf, len);
    free (buf);
    return 0;
}
</tt>
</pre>

<p>This program produces the following output:</p>

<pre>
<tt>buf=hello my world, len=14
buf=good-bye world, len=14
</tt>
</pre>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_07"></a>APPLICATION USAGE</h4>

<blockquote>
<p>The buffer created by these functions should be freed by the application after closing the stream, by means of a call to <a
href="../functions/free.html"><i>free</i>()</a>.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_08"></a>RATIONALE</h4>

<blockquote>
<p>These functions are similar to <a href="../functions/fmemopen.html"><i>fmemopen</i>()</a> except that the memory is always
allocated dynamically by the function, and the stream is opened only for output.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_09"></a>FUTURE DIRECTIONS</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_10"></a>SEE ALSO</h4>

<blockquote>
<p><a href="../functions/fclose.html#"><i>fclose</i></a>, <a href="../functions/fdopen.html#"><i>fdopen</i></a>, <a href=
"../functions/fflush.html#"><i>fflush</i></a>, <a href="../functions/fmemopen.html#"><i>fmemopen</i></a>, <a href=
"../functions/fopen.html#"><i>fopen</i></a>, <a href="../functions/free.html#"><i>free</i></a>, <a href=
"../functions/freopen.html#"><i>freopen</i></a></p>

<p>XBD <a href="../basedefs/stdio.h.html"><i>&lt;stdio.h&gt;</i></a>, <a href=
"../basedefs/wchar.h.html"><i>&lt;wchar.h&gt;</i></a></p>
</blockquote>

<h4 class="mansect"><a name="tag_16_358_11"></a>CHANGE HISTORY</h4>

<blockquote>
<p>First released in Issue 7.</p>

<p>POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0244 [588] and XSH/TC2-2008/0245 [586] are applied.</p>
</blockquote>

<div class="box"><em>End of informative text.</em></div>

<hr>
<p>&nbsp;</p>

<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX &reg; is a registered Trademark of The Open Group.<br>
POSIX &reg; is a registered Trademark of The IEEE.<br>
Copyright &copy; 2001-2018 IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>

<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/open.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/pause.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>
</body>
</html>

