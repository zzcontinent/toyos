<!-- Copyright 2001-2013 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group's rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2013 The Open Group, All Rights Reserved -->
<title>poll</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/pipe.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/popen.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>

<script type="text/javascript" language="JavaScript" src="../jscript/codes.js">
</script>

<basefont size="3"> 

<center><font size="2">The Open Group Base Specifications Issue 7, 2018 edition<br>
IEEE Std 1003.1-2017 (Revision of IEEE Std 1003.1-2008)<br>
Copyright &copy; 2001-2018 IEEE and The Open Group</font></center>

<hr size="2" noshade>
<a name="top"></a> <a name="poll"></a> <a name="tag_16_363"></a><!-- poll -->
 

<h4 class="mansect"><a name="tag_16_363_01"></a>NAME</h4>

<blockquote>poll - input/output multiplexing</blockquote>

<h4 class="mansect"><a name="tag_16_363_02"></a>SYNOPSIS</h4>

<blockquote class="synopsis">
<p><code><tt>#include &lt;<a href="../basedefs/poll.h.html">poll.h</a>&gt;<br>
<br>
 int poll(struct pollfd</tt> <i>fds</i><tt>[], nfds_t</tt> <i>nfds</i><tt>, int</tt> <i>timeout</i><tt>);<br>
</tt></code></p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_03"></a>DESCRIPTION</h4>

<blockquote>
<p>The <i>poll</i>() function provides applications with a mechanism for multiplexing input/output over a set of file descriptors.
For each member of the array pointed to by <i>fds</i>, <i>poll</i>() shall examine the given file descriptor for the event(s)
specified in <i>events</i>. The number of <b>pollfd</b> structures in the <i>fds</i> array is specified by <i>nfds</i>. The
<i>poll</i>() function shall identify those file descriptors on which an application can read or write data, or on which certain
events have occurred.</p>

<p>The <i>fds</i> argument specifies the file descriptors to be examined and the events of interest for each file descriptor. It is
a pointer to an array with one member for each open file descriptor of interest. The array's members are <b>pollfd</b> structures
within which <i>fd</i> specifies an open file descriptor and <i>events</i> and <i>revents</i> are bitmasks constructed by OR'ing a
combination of the following event flags:</p>

<dl compact>
<dt>POLLIN</dt>

<dd>Data other than high-priority data may be read without blocking. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, this flag is set in <i>revents</i> even if the message is of zero length. This flag shall be equivalent to
POLLRDNORM | POLLRDBAND. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></p>
</dd>

<dt>POLLRDNORM</dt>

<dd>Normal data may be read without blocking. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, data on priority band 0 may be read without blocking. This flag is set in <i>revents</i> even if the message is
of zero length. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></p>
</dd>

<dt>POLLRDBAND</dt>

<dd>Priority data may be read without blocking. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, data on priority bands greater than 0 may be read without blocking. This flag is set in <i>revents</i> even if
the message is of zero length. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></p>
</dd>

<dt>POLLPRI</dt>

<dd>High-priority data may be read without blocking. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, this flag is set in <i>revents</i> even if the message is of zero length. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></p>
</dd>

<dt>POLLOUT</dt>

<dd>Normal data may be written without blocking. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, data on priority band 0 may be written without blocking. <img src="../images/opt-end.gif" alt="[Option End]"
border="0"></p>
</dd>

<dt>POLLWRNORM</dt>

<dd>Equivalent to POLLOUT.</dd>

<dt>POLLWRBAND</dt>

<dd>Priority data may be written. 

<p><sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border=
"0"> For STREAMS, data on priority bands greater than 0 may be written without blocking. If any priority band has been written to
on this STREAM, this event only examines bands that have been written to at least once. <img src="../images/opt-end.gif" alt=
"[Option End]" border="0"></p>
</dd>

<dt>POLLERR</dt>

<dd>An error has occurred on the device or stream. This flag is only valid in the <i>revents</i> bitmask; it shall be ignored in
the <i>events</i> member.</dd>

<dt>POLLHUP</dt>

<dd>A device has been disconnected, or a pipe or FIFO has been closed by the last process that had it open for writing. Once set,
the hangup state of a FIFO shall persist until some process opens the FIFO for writing or until all read-only file descriptors for
the FIFO are closed. This event and POLLOUT are mutually-exclusive; a stream can never be writable if a hangup has occurred.
However, this event and POLLIN, POLLRDNORM, POLLRDBAND, or POLLPRI are not mutually-exclusive. This flag is only valid in the
<i>revents</i> bitmask; it shall be ignored in the <i>events</i> member.</dd>

<dt>POLLNVAL</dt>

<dd>The specified <i>fd</i> value is invalid. This flag is only valid in the <i>revents</i> member; it shall ignored in the
<i>events</i> member.</dd>
</dl>

<p>The significance and semantics of normal, priority, and high-priority data are file and device-specific.</p>

<p>If the value of <i>fd</i> is less than 0, <i>events</i> shall be ignored, and <i>revents</i> shall be set to 0 in that entry on
return from <i>poll</i>().</p>

<p>In each <b>pollfd</b> structure, <i>poll</i>() shall clear the <i>revents</i> member, except that where the application
requested a report on a condition by setting one of the bits of <i>events</i> listed above, <i>poll</i>() shall set the
corresponding bit in <i>revents</i> if the requested condition is true. In addition, <i>poll</i>() shall set the POLLHUP, POLLERR,
and POLLNVAL flag in <i>revents</i> if the condition is true, even if the application did not set the corresponding bit in
<i>events</i>.</p>

<p>If none of the defined events have occurred on any selected file descriptor, <i>poll</i>() shall wait at least <i>timeout</i>
milliseconds for an event to occur on any of the selected file descriptors. If the value of <i>timeout</i> is 0, <i>poll</i>()
shall return immediately. If the value of <i>timeout</i> is -1, <i>poll</i>() shall block until a requested event occurs or until
the call is interrupted.</p>

<p>Implementations may place limitations on the granularity of timeout intervals. If the requested timeout interval requires a
finer granularity than the implementation supports, the actual timeout interval shall be rounded up to the next supported
value.</p>

<p>The <i>poll</i>() function shall not be affected by the O_NONBLOCK flag.</p>

<p>The <i>poll</i>() function shall support regular files, terminal and pseudo-terminal devices, FIFOs, pipes, sockets and <sup>[<a
href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
&nbsp;STREAMS-based files. <img src="../images/opt-end.gif" alt="[Option End]" border="0"> The behavior of <i>poll</i>() on
elements of <i>fds</i> that refer to other types of file is unspecified.</p>

<p>Regular files shall always poll TRUE for reading and writing.</p>

<p>A file descriptor for a socket that is listening for connections shall indicate that it is ready for reading, once connections
are available. A file descriptor for a socket that is connecting asynchronously shall indicate that it is ready for writing, once a
connection has been established.</p>

<p>Provided the application does not perform any action that results in unspecified or undefined behavior, the value of the
<i>fd</i> and <i>events</i> members of each element of <i>fds</i> shall not be modified by <i>poll</i>().</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_04"></a>RETURN VALUE</h4>

<blockquote>
<p>Upon successful completion, <i>poll</i>() shall return a non-negative value. A positive value indicates the total number of
<b>pollfd</b> structures that have selected events (that is, those for which the <i>revents</i> member is non-zero). A value of 0
indicates that the call timed out and no file descriptors have been selected. Upon failure, <i>poll</i>() shall return -1 and set
<i>errno</i> to indicate the error.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_05"></a>ERRORS</h4>

<blockquote>
<p>The <i>poll</i>() function shall fail if:</p>

<dl compact>
<dt>[EAGAIN]</dt>

<dd>The allocation of internal data structures failed but a subsequent request may succeed.</dd>

<dt>[EINTR]</dt>

<dd>A signal was caught during <i>poll</i>().</dd>

<dt>[EINVAL]</dt>

<dd>The <i>nfds</i> argument is greater than {OPEN_MAX}, <sup>[<a href="javascript:open_code('OB XSR')">OB XSR</a>]</sup> <img src=
"../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;or one of the <i>fd</i> members refers to a STREAM or multiplexer
that is linked (directly or indirectly) downstream from a multiplexer. <img src="../images/opt-end.gif" alt="[Option End]" border=
"0"></dd>
</dl>
</blockquote>

<hr>
<div class="box"><em>The following sections are informative.</em></div>

<h4 class="mansect"><a name="tag_16_363_06"></a>EXAMPLES</h4>

<blockquote>
<h5><a name="tag_16_363_06_01"></a>Checking for Events on a Stream</h5>

<p>The following example opens a pair of STREAMS devices and then waits for either one to become writable. This example proceeds as
follows:</p>

<ol>
<li>
<p>Sets the <i>timeout</i> parameter to 500 milliseconds.</p>
</li>

<li>
<p>Opens the STREAMS devices <b>/dev/dev0</b> and <b>/dev/dev1</b>, and then polls them, specifying POLLOUT and POLLWRBAND as the
events of interest.</p>

<p>The STREAMS device names <b>/dev/dev0</b> and <b>/dev/dev1</b> are only examples of how STREAMS devices can be named; STREAMS
naming conventions may vary among systems conforming to the POSIX.1-2017.</p>
</li>

<li>
<p>Uses the <i>ret</i> variable to determine whether an event has occurred on either of the two STREAMS. The <i>poll</i>() function
is given 500 milliseconds to wait for an event to occur (if it has not occurred prior to the <i>poll</i>() call).</p>
</li>

<li>
<p>Checks the returned value of <i>ret</i>. If a positive value is returned, one of the following can be done:</p>

<ol type="a">
<li>
<p>Priority data can be written to the open STREAM on priority bands greater than 0, because the POLLWRBAND event occurred on the
open STREAM (<i>fds</i>[0] or <i>fds</i>[1]).</p>
</li>

<li>
<p>Data can be written to the open STREAM on priority-band 0, because the POLLOUT event occurred on the open STREAM (<i>fds</i>[0]
or <i>fds</i>[1]).</p>
</li>
</ol>
</li>

<li>
<p>If the returned value is not a positive value, permission to write data to the open STREAM (on any priority band) is denied.</p>
</li>

<li>
<p>If the POLLHUP event occurs on the open STREAM (<i>fds</i>[0] or <i>fds</i>[1]), the device on the open STREAM has
disconnected.</p>
</li>
</ol>

<pre>
<tt>#include &lt;stropts.h&gt;
#include &lt;poll.h&gt;
...
struct pollfd fds[2];
int timeout_msecs = 500;
int ret;
    int i;
<br>
/* Open STREAMS device. */
fds[0].fd = open("/dev/dev0", ...);
fds[1].fd = open("/dev/dev1", ...);
fds[0].events = POLLOUT | POLLWRBAND;
fds[1].events = POLLOUT | POLLWRBAND;
<br>
ret = poll(fds, 2, timeout_msecs);
<br>
if (ret &gt; 0) {
    /* An event on one of the fds has occurred. */
    for (i=0; i&lt;2; i++) {
        if (fds[i].revents &amp; POLLWRBAND) {
        /* Priority data may be written on device number i. */
...
        }
        if (fds[i].revents &amp; POLLOUT) {
        /* Data may be written on device number i. */
...
        }
        if (fds[i].revents &amp; POLLHUP) {
        /* A hangup has occurred on device number i. */
...
        }
    }
}
</tt>
</pre>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_07"></a>APPLICATION USAGE</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_08"></a>RATIONALE</h4>

<blockquote>
<p>The POLLHUP event does not occur for FIFOs just because the FIFO is not open for writing. It only occurs when the FIFO is closed
by the last writer and persists until some process opens the FIFO for writing or until all read-only file descriptors for the FIFO
are closed.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_09"></a>FUTURE DIRECTIONS</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_10"></a>SEE ALSO</h4>

<blockquote>
<p><a href="../functions/V2_chap02.html#tag_15_06"><i>STREAMS</i></a>, <a href="../functions/getmsg.html#"><i>getmsg</i></a>, <a
href="../functions/pselect.html#"><i>pselect</i></a>, <a href="../functions/putmsg.html#"><i>putmsg</i></a>, <a href=
"../functions/read.html#tag_16_474"><i>read</i></a>, <a href="../functions/write.html#tag_16_685"><i>write</i></a></p>

<p>XBD <a href="../basedefs/poll.h.html"><i>&lt;poll.h&gt;</i></a>, <a href=
"../basedefs/stropts.h.html"><i>&lt;stropts.h&gt;</i></a></p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_11"></a>CHANGE HISTORY</h4>

<blockquote>
<p>First released in Issue 4, Version 2.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_12"></a>Issue 5</h4>

<blockquote>
<p>Moved from X/OPEN UNIX extension to BASE.</p>

<p>The description of POLLWRBAND is updated.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_13"></a>Issue 6</h4>

<blockquote>
<p>Text referring to sockets is added to the DESCRIPTION.</p>

<p>Functionality relating to the XSI STREAMS Option Group is marked.</p>

<p>The Open Group Corrigendum U055/3 is applied, updating the DESCRIPTION of POLLWRBAND.</p>

<p>IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XSH/TC2/D6/66 is applied, correcting the spacing in the EXAMPLES
section.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_363_14"></a>Issue 7</h4>

<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #209 is applied, clarifying the POLLHUP event.</p>

<p>The <i>poll</i>() function is moved from the XSI option to the Base.</p>

<p>Functionality relating to the XSI STREAMS option is marked obsolescent.</p>

<p>POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0249 [623] and XSH/TC2-2008/0250 [683] are applied.</p>
</blockquote>

<div class="box"><em>End of informative text.</em></div>

<hr>
<p>&nbsp;</p>

<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX &reg; is a registered Trademark of The Open Group.<br>
POSIX &reg; is a registered Trademark of The IEEE.<br>
Copyright &copy; 2001-2018 IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>

<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/pipe.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/popen.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>
</body>
</html>

