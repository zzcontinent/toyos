<!-- Copyright 2001-2013 IEEE and The Open Group, All Rights Reserved -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link type="text/css" rel="stylesheet" href="style.css"><!-- Generated by The Open Group's rhtm tool v1.2.4 -->
<!-- Copyright (c) 2001-2013 The Open Group, All Rights Reserved -->
<title>mbsrtowcs</title>
</head>
<body bgcolor="white">
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/mbsinit.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mbstowcs.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>

<script type="text/javascript" language="JavaScript" src="../jscript/codes.js">
</script>

<basefont size="3"> 

<center><font size="2">The Open Group Base Specifications Issue 7, 2018 edition<br>
IEEE Std 1003.1-2017 (Revision of IEEE Std 1003.1-2008)<br>
Copyright &copy; 2001-2018 IEEE and The Open Group</font></center>

<hr size="2" noshade>
<a name="top"></a> <a name="mbsrtowcs"></a> <a name="tag_16_316"></a><!-- mbsrtowcs -->
 

<h4 class="mansect"><a name="tag_16_316_01"></a>NAME</h4>

<blockquote>mbsnrtowcs, mbsrtowcs - convert a character string to a wide-character string (restartable)</blockquote>

<h4 class="mansect"><a name="tag_16_316_02"></a>SYNOPSIS</h4>

<blockquote class="synopsis">
<p><code><tt>#include &lt;<a href="../basedefs/wchar.h.html">wchar.h</a>&gt;<br>
<br>
</tt></code></p>

<div class="box"><code><tt><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> size_t mbsnrtowcs(wchar_t *restrict</tt> <i>dst</i><tt>, const char **restrict</tt>
<i>src</i><tt>,<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t</tt> <i>nmc</i><tt>, size_t</tt> <i>len</i><tt>, mbstate_t *restrict</tt>
<i>ps</i><tt>); <img src="../images/opt-end.gif" alt="[Option End]" border="0"></tt></code></div>

<tt><br>
 size_t mbsrtowcs(wchar_t *restrict</tt> <i>dst</i><tt>, const char **restrict</tt> <i>src</i><tt>,<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t</tt> <i>len</i><tt>, mbstate_t *restrict</tt> <i>ps</i><tt>);<br>
</tt></blockquote>

<h4 class="mansect"><a name="tag_16_316_03"></a>DESCRIPTION</h4>

<blockquote>
<p>For <i>mbsrtowcs</i>(): <sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> &nbsp;The functionality described on this reference page is aligned with the ISO&nbsp;C standard. Any
conflict between the requirements described here and the ISO&nbsp;C standard is unintentional. This volume of POSIX.1-2017 defers
to the ISO&nbsp;C standard. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></p>

<p>The <i>mbsrtowcs</i>() function shall convert a sequence of characters, beginning in the conversion state described by the
object pointed to by <i>ps</i>, from the array indirectly pointed to by <i>src</i> into a sequence of corresponding wide
characters. If <i>dst</i> is not a null pointer, the converted characters shall be stored into the array pointed to by <i>dst</i>.
Conversion continues up to and including a terminating null character, which shall also be stored. Conversion shall stop early in
either of the following cases:</p>

<ul>
<li>
<p>A sequence of bytes is encountered that does not form a valid character.</p>
</li>

<li>
<p><i>len</i> codes have been stored into the array pointed to by <i>dst</i> (and <i>dst</i> is not a null pointer).</p>
</li>
</ul>

<p>Each conversion shall take place as if by a call to the <a href="../functions/mbrtowc.html"><i>mbrtowc</i>()</a> function.</p>

<p>If <i>dst</i> is not a null pointer, the pointer object pointed to by <i>src</i> shall be assigned either a null pointer (if
conversion stopped due to reaching a terminating null character) or the address just past the last character converted (if any). If
conversion stopped due to reaching a terminating null character, and if <i>dst</i> is not a null pointer, the resulting state
described shall be the initial conversion state.</p>

<p>If <i>ps</i> is a null pointer, the <i>mbsrtowcs</i>() function shall use its own internal <b>mbstate_t</b> object, which is
initialized at program start-up to the initial conversion state. Otherwise, the <b>mbstate_t</b> object pointed to by <i>ps</i>
shall be used to completely describe the current conversion state of the associated character sequence.</p>

<p><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> The
<i>mbsnrtowcs</i>() function shall be equivalent to the <i>mbsrtowcs</i>() function, except that the conversion of characters
indirectly pointed to by <i>src</i> is limited to at most <i>nmc</i> bytes (the size of the input buffer), and under conditions
where <i>mbsrtowcs</i>() would assign the address just past the last character converted (if any) to the pointer object pointed to
by <i>src</i>, <i>mbsnrtowcs</i>() shall instead assign the address just past the last byte processed (if any) to that pointer
object. If the input buffer ends with an incomplete character, it is unspecified whether conversion stops at the end of the
previous character (if any), or at the end of the input buffer. In the latter case, a subsequent call to <i>mbsnrtowcs</i>() with
an input buffer that starts with the remainder of the incomplete character shall correctly complete the conversion of that
character. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></p>

<p>The behavior of these functions shall be affected by the <i>LC_CTYPE</i> category of the current locale.</p>

<p>The implementation shall behave as if no function defined in this volume of POSIX.1-2017 calls these functions.</p>

<p><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0"> The
<i>mbsnrtowcs</i>() and <i>mbsrtowcs</i>() functions need not be thread-safe if called with a NULL <i>ps</i> argument. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></p>

<p>The <i>mbsrtowcs</i>() function shall not change the setting of <i>errno</i> if successful.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_04"></a>RETURN VALUE</h4>

<blockquote>
<p>If the input conversion encounters a sequence of bytes that do not form a valid character, an encoding error occurs. In this
case, these functions shall store the value of the macro [EILSEQ] in <i>errno</i> and shall return (<b>size_t</b>)-1; the
conversion state is undefined. Otherwise, these functions shall return the number of characters successfully converted, not
including the terminating null (if any).</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_05"></a>ERRORS</h4>

<blockquote>
<p>These functions shall fail if:</p>

<dl compact>
<dt>[EILSEQ]</dt>

<dd>An invalid character sequence is detected. <sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src=
"../images/opt-start.gif" alt="[Option Start]" border="0"> &nbsp;In the POSIX locale an [EILSEQ] error cannot occur since all byte
values are valid characters. <img src="../images/opt-end.gif" alt="[Option End]" border="0"></dd>
</dl>

<p>These functions may fail if:</p>

<dl compact>
<dt>[EINVAL]</dt>

<dd><sup>[<a href="javascript:open_code('CX')">CX</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
<i>ps</i> points to an object that contains an invalid conversion state. <img src="../images/opt-end.gif" alt="[Option End]"
border="0"></dd>
</dl>
</blockquote>

<hr>
<div class="box"><em>The following sections are informative.</em></div>

<h4 class="mansect"><a name="tag_16_316_06"></a>EXAMPLES</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_07"></a>APPLICATION USAGE</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_08"></a>RATIONALE</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_09"></a>FUTURE DIRECTIONS</h4>

<blockquote>
<p>A future version may require that when the input buffer ends with an incomplete character, conversion stops at the end of the
input buffer.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_10"></a>SEE ALSO</h4>

<blockquote>
<p><a href="../functions/iconv.html#tag_16_232"><i>iconv</i></a>, <a href="../functions/mbrtowc.html#"><i>mbrtowc</i></a>, <a
href="../functions/mbsinit.html#"><i>mbsinit</i></a></p>

<p>XBD <a href="../basedefs/wchar.h.html"><i>&lt;wchar.h&gt;</i></a></p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_11"></a>CHANGE HISTORY</h4>

<blockquote>
<p>First released in Issue 5. Included for alignment with ISO/IEC&nbsp;9899:1990/Amendment 1:1995 (E).</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_12"></a>Issue 6</h4>

<blockquote>
<p>The <i>mbsrtowcs</i>() prototype is updated for alignment with the ISO/IEC&nbsp;9899:1999 standard.</p>

<p>The [EINVAL] error condition is marked CX.</p>
</blockquote>

<h4 class="mansect"><a name="tag_16_316_13"></a>Issue 7</h4>

<blockquote>
<p>Austin Group Interpretation 1003.1-2001 #170 is applied.</p>

<p>The <i>mbsnrtowcs</i>() function is added from The Open Group Technical Standard, 2006, Extended API Set Part 1.</p>

<p>POSIX.1-2008, Technical Corrigendum 1, XSH/TC1-2008/0370 [109,105] is applied.</p>

<p>POSIX.1-2008, Technical Corrigendum 2, XSH/TC2-2008/0205 [601], XSH/TC2-2008/0206 [663], and XSH/TC2-2008/0207 [601] are
applied.</p>
</blockquote>

<div class="box"><em>End of informative text.</em></div>

<hr>
<p>&nbsp;</p>

<a href="#top"><span class="topOfPage">return to top of page</span></a><br>
<hr size="2" noshade>
<center><font size="2">UNIX &reg; is a registered Trademark of The Open Group.<br>
POSIX &reg; is a registered Trademark of The IEEE.<br>
Copyright &copy; 2001-2018 IEEE and The Open Group, All Rights Reserved<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../functions/contents.html">XSH</a> | <a href="../utilities/contents.html">XCU</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>

<hr size="2" noshade>
<div class="NAVHEADER">
<table summary="Header navigation table" class="nav" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="nav">
<td class="nav" width="15%" align="left" valign="bottom"><a href="../functions/mbsinit.html" accesskey="P">&lt;&lt;&lt;
Previous</a></td>
<td class="nav" width="70%" align="center" valign="bottom"><a href="contents.html">Home</a></td>
<td class="nav" width="15%" align="right" valign="bottom"><a href="../functions/mbstowcs.html" accesskey="N">Next
&gt;&gt;&gt;</a></td>
</tr>
</table>

<hr align="LEFT" width="100%">
</div>
</body>
</html>

